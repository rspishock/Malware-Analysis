#! /usr/bin/python

from os import path

import argparse
import re


def get_arguments():
    """Get user supplied arguments from terminal."""
    parser = argparse.ArgumentParser()
    parser.add_argument('-i', '--input', dest='input', help='File to parse strings from.')
    parser.add_argument('-d', '--descriptor', dest='descriptor', help='Malware descriptor.  Will be used to append '
                                                                      'regex outputs to')
    (options) = parser.parse_args()

    return options

# argument variables
options = get_arguments()
input_file = options.input
descriptor = options.descriptor

# user variables
path_count = 0
dll_count = 0
crypto_count = 0
path_count = 0

try:
    if path.exists(input_file):
        # file to read from
        with open(file_name) as file_object:
            with open(file_out, 'w') as output:
                for line in file_object:
                    # dll regex
                    dll_regex = re.compile(f'[a-b0-9].dll')
                    dll_string = dll_regex.search(line)

                    # write dll files to file_out.txt
                    file_out.write(f'\t{dll_string}')

                    # increment dll count
                    dll_count + 1

                    file_out.write(f'Total number of .dll files found: {dll_count}')

                    # file path regex
                    path_regex = re.compile(f'C:\\[a-z0-9]\\')
                    path_string = path_regex.search(line)

                    # increment path count
                    path_count + 1

                    # crypto regex


            # total number of dll files found
            print(f'Found {dll_count} dll files.  Check ')

else:
  print(f'File {file_name} does not exist.')
  print('Check filename and rerun script.')
  # return
